	<meta name="viewport" content="width=device-width, initial-scale=1">
	<!-- Latest compiled and minified CSS -->
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css">
	<!-- Data Tables CSS -->
	<link rel="stylesheet" href="https://system{{ subdomain }}.netsuite.com/c.1291624/TrueCloud/customerDisplay/datatables/css/jquery.dataTables.min.css">
	<!-- jquery UI css -->
	<link rel="stylesheet" href="https://system{{ subdomain }}.netsuite.com/c.1291624/TrueCloud/customerDisplay/css/jquery-ui.css">
	<!-- -TrueCloud Styles -->
	<link rel="stylesheet" href="https://system{{ subdomain }}.netsuite.com/c.1291624/TrueCloud/customerDisplay/css/tcStyle.css">
	<!-- Tooltip -->
	<link rel="stylesheet" href="https://system{{ subdomain }}.netsuite.com/c.1291624/TrueCloud/customerDisplay/css/jquery.qtip.min.css">
	<style>
	.same-height{
		height:240px;
	}
	table.dataTable tbody th, table.dataTable tbody td {
		vertical-align: top;
	}
	input.date-box {
		font-size: 10px;
	}
	.response-fader{
		color: #15943D;
	}
	.dataTables_scrollBody{
		min-height: 32px;
	}
	h4{
		text-transform: uppercase;
		margin: -8px 0px 0px 0px;
		padding: 6px 4px;
		background: #DFE4EB;
		color:#25507A;
	}
	h4.tier-color {
		color: black;
	}
	.cust-clicker{
		cursor: pointer;
	}
	.cust-clicker:hover{
		color:#25507A;
		text-decoration: underline;
	}
	#openProj{    
		overflow-y:scroll;
		overflow-x:hidden; 
	}
	#professional-services-table {
		overflow-x: hidden;
	}
	#zero_pd_box{
		margin-top: -24px; 
		margin-bottom: 12px;
	}
	@media (max-width: 767px) {
		#zero_pd_box{
			margin:auto;
		}
		#body{
			min-width: 0px!important;
		}
	}
	#correspondenceTable td{
		word-wrap:break-word;
	}
	#correspondenceTable td:nth-child(2){
		max-width: 37px;
	}
	#correspondenceTable td:nth-child(3){
		max-width: 92px;
	}
	#correspondenceTable td:nth-child(4){
		max-width: 41px;
	}
	#theTable{
		border-collapse: separate;
  		border-spacing: 2px;
	}
	#theTable td, #theTable th{
		padding:2px;
	}
	#theTable thead tr td{
		font-size: 12px;
	}
	#theTable .labelCol{
		color:#000;
	}
	</style>
	<div class="container">
		<div class="row">
			<div class="col-md-12 text-center">
				<h2>Customer</h2><hr>
			</div>
		</div>
		<div class="row">
						<div class="col-md-8">
				<h3>{{ entityid }} {{ companyname }}</a></h3>
			</div>
			<div class="col-md-4">
					<h3 class="pull-right" style="font-size:16px"><a href="https://system{{ subdomain }}.netsuite.com/app/common/entity/custjob.nl?id={{ internalid }}&esc=T" target="_blank">VIEW</a>
					|
					<a href="https://system{{ subdomain }}.netsuite.com/app/common/entity/custjob.nl?id={{ internalid }}&e=T&esc=T" target="_blank">EDIT</a>
					{{#tooltip_content}}|
					<a href="#" id="integratedtooltip" class="dottedlink">View Weld North Integration</a></h3>{{/tooltip_content}}
					<p class="pull-right" id="tooltip-searching" style="display:none">Searching...</p>
			</div>
		</div>
		<div class="row">
			<div class="col-md-5 left-column">
				<div class="row">
					<div class="col-md-12">
						<div class="boxman">
							<div class="row">
								<div class="col-md-12">
									<h4>Customer</h4>
								</div>
							</div>
							<div class="row">
								<div class="col-md-12">
									<span class="title-boss">Customer/Prospect ID :</span>
									<span class="value-boss">{{ entityid }}</span>
								</div>
							</div>
							<div class="row">
								<div class="col-md-12">
									<span class="title-boss">Company Name :</span>
									<span class="value-boss">{{ companyname }}</span>
								</div>
							</div>
							<div class="row">
								<div class="col-md-12">
									<span class="title-boss">District :</span>
									<span class="value-boss">{{ custentity_district }}</span>
								</div>
							</div>
							<div class="row">
								<div class="col-md-12">
									<span class="title-boss">State :</span>
									<span class="value-boss">{{ billstate }}</span>
								</div>
							</div>
							<div class="row">
								<div class="col-md-12">
									<span class="title-boss">Service Region :</span>
									<span class="value-boss">{{ custentitypd_territory_mapping }}</span>
								</div>
							</div>
							<div class="row">
								<div class="col-md-12">
									<span class="title-boss">Prod Dist ID :</span>
									<span class="value-boss">{{ custentity2 }}</span>
								</div>
							</div>
							<div class="row">
								<div class="col-md-12">
									<span class="title-boss">Status :</span>
									<span class="value-boss">{{ entitystatus }}</span>
								</div>
							</div>
							<div class="row">
								<div class="col-md-12">
									<span class="title-boss">Category :</span>
									<span class="value-boss">{{ category }}</span>
								</div>
							</div>
							<div class="row">
								<div class="col-md-12">
									<span class="title-boss">Implementation Advisor :</span>
									<span class="value-boss">{{ imp_advisor.name }} | {{ imp_advisor.email }} | {{ imp_advisor.phone }}</span>
								</div>
							</div>
							<div class="row">
								<div class="col-md-12">
									<span class="title-boss">Partnership Advisor :</span>
									<span class="value-boss">{{ partnership_advisor.firstname }} {{ partnership_advisor.lastname }} | {{ partnership_advisor.email }}</span>
								</div>
							</div>
							<div class="row">
								<div class="col-md-12">
									<span class="title-boss">Primary Contact :</span>
									<span class="value-boss">{{ primary_contact.firstname }} {{ primary_contact.lastname }} | {{ primary_contact.email }} | {{ primary_contact.phone }}</span>
								</div>
							</div>
							<div class="row">
								<div class="col-md-12">
									<span class="title-boss">Sales Rep :</span>
									<span class="value-boss">{{ salesrep }}</span>
								</div>
							</div>
							<div class="row">
								<div class="col-md-12">
									<span class="title-boss">Implementation Coach :</span>
									<span class="value-boss">{{ custentity_pd_consultant }}</span>
								</div>
							</div>
							<div class="row">
								<div class="col-md-12">
									<span class="title-boss">IT / Field Engineer :</span>
									<span class="value-boss">{{ custentity_itsales_eng }}</span>
								</div>
							</div>
							<div class="row">
								<div class="col-md-12">
									<a href="https://system{{ subdomain }}.netsuite.com/app/common/search/searchresults.nl?searchtype=Contact&Contact_COMPANY={{internalid}}&style=NORMAL&searchid=customsearch_customer_page_contacts&size=1000" target="_blank" class="btn btn-primary btn-xs">Contacts List in NetSuite</a>
								</div>
							</div>
						</div>
						<!-- end boxman -->
					</div>
					<!-- end col 12 -->
				</div>
				<div class="row">
					<div class="col-md-12">
						<div class="boxman">
							<div class="row">
								<div class="col-md-12">
									<h4>Correspondence</h4>
								</div>
							</div>
							<div class="row">
								<div class="col-md-12">
									<table id="correspondenceTable" class="table-striped" cellspacing="0" width="100%">
										<thead>
											<tr>
												<th>Date</th>
												<th>Author</th>
												<th>Recipient</th>
												<th>Subject</th>
												<th>Message</th>
											</tr>
										</thead>
										<tbody>
											{{ #messages }}
											<tr>
												<td>{{ messagedate }}</td>
												<td>{{ author }}</td>
												<td>{{ recipient }}</td>
												<td>{{ subject }}</td>
												<td class="correspondance_msg">{{ message }}</td>
											</tr>
											{{ /messages }}
										</tbody>
									</table>
								</div>
							</div>
							<div class="row">
								<div class="col-md-12">
									<a href="https://system{{ subdomain }}.netsuite.com/app/common/search/searchresults.nl?searchtype=Customer&Entity_INTERNALID={{ internalid }}&style=NORMAL&report=&grid=&dle=T&sortcol=Entity_ENTITYID_raw&sortdir=ASC&csv=HTML&OfficeXML=F&pdf=&size=1000&scrollid=customsearch_customer_page_messages&searchid=customsearch_customer_page_messages&refresh=&whence=" target="_blank" class="btn btn-primary btn-xs">View All Messages</a>
								</div>
							</div>
						</div>
						<!-- end boxman -->
					</div>
				</div>
				<!-- end row -->
				<div class="row">
					<div class="col-md-12">
						<div class="boxman">
							<div class="row">
								<div class="col-md-12">
									<h4>Tasks</h4>
								</div>
							</div>
							<div class="row">
								<div class="col-md-12">
									<table id="taskTable" class="table-striped" cellspacing="0" width="100%">
										<thead>
											<tr>
												<th>Date</th>
												<th>Task Title</th>
												<th>AM Task Type</th>
											</tr>
										</thead>
										<tbody>
											{{ #tasks }}
											<tr>
												<td>{{ startdate }}</td>
												<td>{{ title }}</td>
												<td>{{ custeventam_task_type }}</td>
											</tr>
											{{ /tasks }}
										</tbody>
									</table>
								</div>
							</div>
							<div class="row">
								<div class="col-md-12">
									<a href="https://system{{ subdomain }}.netsuite.com/app/common/search/searchresults.nl?searchtype=Task&CU_Entity_ENTITYID={{ entityid }}&CU_Entity_ENTITYIDtype=CONTAINS&style=NORMAL&report=&grid=&searchid=customsearch_customer_page_tasks&dle=T&sortcol=Task_ORDERNUMBER_raw&sortdir=ASC&csv=HTML&OfficeXML=F&pdf=&size=1000" target="_blank" class="btn btn-primary btn-xs">View All Tasks</a>
								</div>
							</div>
						</div>
						<!-- end boxman -->
					</div>
				</div>
				<!-- end row -->
				<div class="row">
					<div class="col-md-12">
						<div class="boxman">
							<div class="row">
								<div class="col-md-12">
									<h4>Support</h4>
								</div>
							</div>
							<div class="row">
								<div class="col-md-12">
									<table id="supportTable" class="table-striped" cellspacing="0" width="100%">
										<thead>
											<tr>
												<th>Date Created</th>
												<th>Subject</th>
												<th>Origin</th>
												<th>Status</th>
											</tr>
										</thead>
										<tbody>
											{{ #cases }}
											<tr>
												<td>{{ createddate }}</td>
												<td>{{ title }}</td>
												<td>{{ origin }}</td>
												<td>{{ status }}</td>
											</tr>
											{{ /cases }}
										</tbody>
									</table>
								</div>
							</div>
							<div class="row">
								<div class="col-md-12">
									<a href="#" target="_blank" id="cases-link" class="btn btn-primary btn-xs">View All Cases</a>
								</div>
							</div>
						</div>
						<!-- end boxman -->
					</div>
				</div>
				<!-- end row -->
			</div>
			<!-- end left column -->
			<div class="col-md-7 right-column">
				<div class="row">
					<div class="col-md-6 squeeze">
						<div class="boxman same-height">
							<div class="row">
								<div class="col-md-12">
									<h4>General Account Details</h4>
								</div>
							</div>
							<div class="row">
								<div class="col-md-12">
									<span class="title-boss">Contract Expiration :</span>
									<span>{{ max_po_expiration }}</span>
								</div>
							</div>
							<div class="row">
								<div class="col-md-12">
									<span class="title-boss">License Type(s) & QTY : </span>
									<ul>
										<li>Dedicated Licenses: {{ total_dedicated_lic }}</li>
										<li>Shared Licenses: {{ total_shared_lic }}</li>
										<li>Site Licenses: {{ total_site_lic }}</li>
									</ul>
								</div>
							</div>
							<div class="row">
								<div class="col-md-12">
									<span class="title-boss">Course Count :</span>
									<span>{{ total_courses }}</span>
								</div>
							</div>
							<div class="row">
								<div class="col-md-12">
									<span class="title-boss">Media Appliance :</span>
									<ul>
											{{#media_appliances_latest_active_so }}
										<li>{{ item }} : {{ quantity }}</li>
											{{ /media_appliances_latest_active_so }}
									</ul>
								</div>
							</div>
							<div class="row">
								<div class="col-md-12">
									<span class="title-boss">Active IS Order :</span> {{activeIsOrder}}
								</div>
							</div>
							<div class="row">
								<div class="col-md-12">
									<a href="https://system{{ subdomain }}.netsuite.com/app/common/search/searchresults.nl?searchtype=Transaction&CN_Entity_ENTITYID={{ entityid }} &style=NORMAL&CN_Entity_ENTITYIDtype=STARTSWITH&report=&grid=&dle=T&sortcol=Transaction_TRANDATE_raw&sortdir=ASC&csv=HTML&OfficeXML=F&pdf=&size=200&twbx=F&searchid=customsearch_all_transactions" target="_blank" class="btn btn-primary btn-xs">Transactions List in NetSuite</a>
								</div>
							</div>
						</div>
					</div>
					<div class="col-md-6 squeeze">
						<div class="boxman same-height">
							<div class="row">
								<div class="col-md-12">
									<h4 class="tier-color {{ custentity293 }}">{{ custentity293 }}</h4>
								</div>
							</div>
							<div class="row">
								<div class="col-md-12">
									<div class="checkbox">
										<h5>PA EVENTS</h5>
									</div>
								</div>
							</div>
							<div class="row">
								<div class="col-md-12">
									<div class="checkbox">
										<label>
											<input type="checkbox" id="custentity_exempt_paevent">Exempt (For
											<span style="color:#777;text-decoration:underline;">SILVER</span>&nbsp;Accounts)
										</label>
									</div>
								</div>
							</div>
							<div class="row">
								<div class="col-md-12">
									<div class="checkbox">
										<label>
											<input type="checkbox" id="custentity_imp_mtg">Implementation Meeting Date:
											<input type="text" class="date-box" size="12" id="custentity_imp_mtg_date" value="{{ professional_dev.imp_mtg_date }}"/>
										</label>
									</div>
								</div>
							</div>
							<div class="row">
								<div class="col-md-12">
									<div class="checkbox">
										<label>
											<input type="checkbox" id="custentity_midyear_review">Midyear Review Date:
											<input type="text" class="date-box" size="12" id="custentity_midyear_review_date" value="{{ professional_dev.midyear_review_date }}"/>
										</label>
									</div>
								</div>
							</div>
							<div class="row">
								<div class="col-md-12">
									<div class="checkbox">
										<label>
											<input type="checkbox" id="custentity_endofyear_review">End of Year Review Date:
											<input type="text" class="date-box" size="12" id="custentity_endofyear_review_date" value="{{ professional_dev.endofyear_review_date }}"/>
										</label>
									</div>
								</div>
							</div>
							<div class="row">
								<div class="col-md-12">
									<div class="checkbox">
										<label>
											Next Follow-up Date:
											<input type="text" class="date-box" size="12" id="custentity_followup_date" value="{{ professional_dev.followup_date }}"/>
										</label>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
				{{ #professional_dev }}
				<div class="row pro-dev">
					<div class="col-md-12">
						<div class="boxman">
							<div class="row">
								<div class="col-md-12">
									<h4>Professional Development</h4>
								</div>
							</div>
							<div class="row">
								<div class="col-md-5 col-md-offset-7" id="zero_pd_box">
									<div class="checkbox" style="margin-top: 0px;">
										<label>
											<input type="checkbox" name="custentity_0_pd_remaining" id="custentity_0_pd_remaining">0 PD Remaining
										</label>
									</div>
								</div>
							</div>
							<div class="row">
								<div class="col-md-3">Training Plan</div>
								<div class="col-md-2">
									<div class="checkbox no-margin">
										<label>
											<input type="checkbox" id="custentity_train_plan_saved">Saved
										</label>
									</div>
								</div>
								<div class="col-md-2">
									<div class="checkbox no-margin">
										<label>
											<input type="checkbox" id="custentity_train_plan_exempt">Exempt
										</label>
									</div>
								</div>
								<div class="col-md-5">
									PD Remaining Webinar:
									<span class="value-boss">{{ pd_remaining_days_webinar }}</span>
									<br/>
									PD Remaining Onsite:
									<span class="value-boss">{{ pd_remaining_days_onsite }}</span>
								</div>
							</div>
							<div class="row">
								<div class="col-md-12">
									<br>
									<table class="table table-bordered" cellspacing="0" width="100%">
										<tr>
											<td colspan="4">PD Days</td>
										</tr>
										<tr>
											<th class="bold-boy">Onsite Purchased</th>
											<th class="bold-boy">{{ professional_dev.pd_onsite_purchased_days }}</th>
											<th class="bold-boy">Web Purchased</th>
											<th class="bold-boy">{{ professional_dev.pd_web_purchased_days }}</th>
										</tr>
									</table>
									<table class="table-striped" cellspacing="0" width="100%" id="professional-services-table">
										<thead>
											<tr>
												<th class="bold-boy">Start Date</th>
												<th class="bold-boy">Name</th>
												<th class="bold-boy">Status</th>
											</tr>
										</thead>
										<tbody>
											{{ #project_fields }}
											<tr class="cust-clicker" onclick="window.location='https://system{{ subdomain }}.netsuite.com/app/accounting/project/project.nl?id={{internalid}}&e=T'">
												<td>{{ startdate }}</td>
												<td>{{ project }}</td>
												<td>{{ status }}</td>
											</tr>
											{{ /project_fields }}
										</tbody>
									</table>
								</div>
							</div>
						</div>
					</div>
				</div>
				{{ /professional_dev }}
				<div class="row">
					<div class="col-md-12">
						<div class="boxman">
							<div class="row">
								<div class="col-md-12">
									<h4>Files</h4>
								</div>
							</div>
							<div class="row">
								<div class="col-md-4">Implementation Plan Form</div>
								<div class="col-md-2">
									<div class="checkbox no-margin">
										<label>
											<input type="checkbox" id="custentity_imp_plan_saved">Saved
										</label>
									</div>
								</div>
								<div class="col-md-2">
									<div class="checkbox no-margin">
										<label>
											<input type="checkbox" id="custentity_imp_plan_exempt">Exempt
										</label>
									</div>
								</div>
							</div>
							<div class="row">
								<div class="col-md-12">
									<br>
									<table class="table-striped" cellspacing="0" width="100%" id="files">
										<thead>
											<tr>
												<th>Attached Files</th>
												<th>Size</th>
												<th>Last Modified</th>
												<th>Document Type</th>
												<th>Edit</th>
												<th>Download</th>
											</tr>
										</thead>
										<tbody>
											{{ #files }}
											<tr>
												<td>{{ name }}</td>
												<td>{{ documentsize }}</td>
												<td>{{ modified }}</td>
												<td>{{ filetype }}</td>
												<td><a href="#" class="edit-file" data-file-id="{{ internalid }}">Edit</a>
												</td>
												<td><a href="#" class="download-file" data-file-id="{{ internalid }}">Download</a>
												</td>
											</tr>
											{{ /files }}
										</tbody>
									</table>
								</div>
							</div>
							<div class="row">
								<div class="col-md-12">
									<a href="https://system{{ subdomain }}.netsuite.com/app/common/search/searchresults.nl?searchtype=Customer&Entity_INTERNALID={{ internalid }}&style=NORMAL&report=&grid=&searchid=customsearch_customer_page_files&dle=T&sortcol=Entity_ENTITYID_raw&sortdir=ASC&csv=HTML&OfficeXML=F&pdf=&size=1000" target="_blank" class="btn btn-primary btn-xs">View All Files</a>
								</div>
							</div>
						</div>
					</div>
				</div>
				<div class="row">
					<div class="col-md-12">
						<div class="boxman">
							<div class="row">
								<div class="col-md-12">
									<h4>Open Hubs</h4>
								</div>
							</div>
							<div class="row">
								<div class="col-md-12">
									<table id="openHubs" class="table-striped" cellspacing="0" width="100%">
										<thead>
											<tr>
												<th>SO#</th>
												<th>Name</th>
											</tr>
										</thead>
										<tbody>
											{{ #hubs }}
											<tr>
												<td>{{ custrecord_sales_order }}</td>
												<td>{{ name }}</td>
											</tr>
											{{ /hubs }}
										</tbody>
									</table>
								</div>
							</div>
							<div class="row">
								<div class="col-md-12">
									<a href="https://system{{ subdomain }}.netsuite.com/app/common/search/searchresults.nl?rectype=62&searchtype=Custom&ABL_Transaction_NAME={{ internalid }}&style=NORMAL&report=&grid=&searchid=customsearch_customer_page_hubs&dle=T&sortcol=Custom_INTERNALID_raw&sortdir=DESC&csv=HTML&OfficeXML=F&pdf=&size=1000" target="_blank" class="btn btn-primary btn-xs">View All Hubs</a>
								</div>
							</div>
						</div>
					</div>
				</div>
				<div class="row">
					<div class="col-md-12">
						<div class="boxman">
							<div class="row">
								<div class="col-md-12">
									<h4>Projects</h4>
								</div>
							</div>
							<div class="row">
								<div class="col-md-12">
									<table id="openProj" class="table-striped" cellspacing="0">
										<thead>
											<tr>
												<th>Start Date</th>
												<th>Name</th>
											</tr>
										</thead>
										<tbody>
											{{ #open_projects }}
											<tr>
												<td>{{ startdate }}</td>
												<td>{{ entityid }}</td>
											</tr>
											{{ /open_projects }}
										</tbody>
									</table>
								</div>
							</div>
							<div class="row">
								<div class="col-md-12">
									<a href="https://system{{ subdomain }}.netsuite.com/app/common/search/searchresults.nl?searchtype=Job&Job_CUSTOMER={{internalid}}&style=NORMAL&report=&grid=&searchid=customsearch_customer_page_open_proj&dle=T&sortcol=Job_STARTDATE_raw&sortdir=DESC&csv=HTML&OfficeXML=F&pdf=&size=1000" target="_blank" class="btn btn-primary btn-xs">View All Projects</a>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
			<!-- end right column -->
		</div>
	</div>
<div id="theTableWrapper" style="display:none">
	<table id="theTable" class="detailList" border="1" style="border:1px solid black; table-layout:fixed; width:950px">
	<thead>
	<tr class="companyName" style="color:rgb(0,0,0); font-family:Arial, Helvetica, sans-serif; font-size:12px;">
		<td width="135px" style="border:1px solid black; overflow:hidden;"></td>
		<td class="dataCol ajaxFailure" style="border:1px solid black;font-weight:bold;overflow:hidden;background-color: {edgenuity_color};"><div id="edgenuity_logo">Edgenuity</div></td>
		<td class="dataCol ajaxFailure" style="border:1px solid black;font-weight:bold;overflow:hidden;background-color: {genready_color};"><div id="genready_logo">Generation Ready</div></td>
		<td class="dataCol ajaxFailure" style="border:1px solid black;font-weight:bold;overflow:hidden;background-color: {imagine_color};"><div id="imagine_logo">Imagine Learning</div></td>
		<td class="dataCol ajaxFailure" style="border:1px solid black;font-weight:bold;overflow:hidden;background-color: {truenorth_color};"><div id="truenorth_logo">truenorthlogic</div></td>

	</tr>
	</thead>
	<tbody>
	<tr style="display:none">
		<td class="labelCol" style="border:1px solid black;overflow:hidden;font-weight:bold;">Annual Contract Value</td>
		<td style="color:rgb(0,0,0);font-family:Arial, Helvetica, sans-serif;font-size:12px;border:1px solid black; overflow:hidden;">{edgenuity_annualvalue}</td>
		<td style="color:rgb(0,0,0);font-family:Arial, Helvetica, sans-serif;font-size:12px;border:1px solid black; overflow:hidden;">{genready_annualvalue}</td>
		<td style="color:rgb(0,0,0);font-family:Arial, Helvetica, sans-serif;font-size:12px;border:1px solid black; overflow:hidden;">{imagine_annualvalue}</td>
		<td style="color:rgb(0,0,0);font-family:Arial, Helvetica, sans-serif;font-size:12px;border:1px solid black; overflow:hidden;">{truenorth_annualvalue}</td>
	</tr>
	<tr>
		<td class="labelCol" style="border:1px solid black;overflow:hidden;font-weight:bold;">Annual Rank</td>
		<td style="color:rgb(0,0,0);font-family:Arial, Helvetica, sans-serif;font-size:12px;border:1px solid black; overflow:hidden;">{edgenuity_rank}</td>
		<td style="color:rgb(0,0,0);font-family:Arial, Helvetica, sans-serif;font-size:12px;border:1px solid black; overflow:hidden;">{genready_rank}</td>
		<td style="color:rgb(0,0,0);font-family:Arial, Helvetica, sans-serif;font-size:12px;border:1px solid black; overflow:hidden;">{imagine_rank}</td>
		<td style="color:rgb(0,0,0);font-family:Arial, Helvetica, sans-serif;font-size:12px;border:1px solid black; overflow:hidden;">{truenorth_rank}</td>		
	</tr>
	<tr>
		<td class="labelCol" style="border:1px solid black;overflow:hidden;font-weight:bold;">Customer since</td>
		<td style="color:rgb(0,0,0);font-family:Arial, Helvetica, sans-serif;font-size:12px;border:1px solid black; overflow:hidden;">{edgenuity_customersince}</td>
		<td style="color:rgb(0,0,0);font-family:Arial, Helvetica, sans-serif;font-size:12px;border:1px solid black; overflow:hidden;">{genready_customersince}</td>
		<td style="color:rgb(0,0,0);font-family:Arial, Helvetica, sans-serif;font-size:12px;border:1px solid black; overflow:hidden;">{imagine_customersince}</td>
		<td style="color:rgb(0,0,0);font-family:Arial, Helvetica, sans-serif;font-size:12px;border:1px solid black; overflow:hidden;">{truenorth_customersince}</td>
	</tr>
	<tr>
		<td class="labelCol" style="border:1px solid black;overflow:hidden;font-weight:bold;">Last purchase</td>
		<td style="color:rgb(0,0,0);font-family:Arial, Helvetica, sans-serif;font-size:12px;border:1px solid black; overflow:hidden;">{edgenuity_lastpurchase}</td>
		<td style="color:rgb(0,0,0);font-family:Arial, Helvetica, sans-serif;font-size:12px;border:1px solid black; overflow:hidden;">{genready_lastpurchase}</td>
		<td style="color:rgb(0,0,0);font-family:Arial, Helvetica, sans-serif;font-size:12px;border:1px solid black; overflow:hidden;">{imagine_lastpurchase}</td>
		<td style="color:rgb(0,0,0);font-family:Arial, Helvetica, sans-serif;font-size:12px;border:1px solid black; overflow:hidden;">{truenorth_lastpurchase}</td>
	</tr>
	<tr>
		<td class="labelCol" style="border:1px solid black;overflow:hidden;font-weight:bold;">Sales rep name</td>
		<td style="color:rgb(0,0,0);font-family:Arial, Helvetica, sans-serif;font-size:12px;border:1px solid black; overflow:hidden;">{edgenuity_salesrep}</td>
		<td style="color:rgb(0,0,0);font-family:Arial, Helvetica, sans-serif;font-size:12px;border:1px solid black; overflow:hidden;">{genready_salesrep}</td>
		<td style="color:rgb(0,0,0);font-family:Arial, Helvetica, sans-serif;font-size:12px;border:1px solid black; overflow:hidden;">{imagine_salesrep}</td>
		<td style="color:rgb(0,0,0);font-family:Arial, Helvetica, sans-serif;font-size:12px;border:1px solid black; overflow:hidden;">{truenorth_salesrep}</td>
	</tr>
	<tr>
		<td class="labelCol" style="border:1px solid black;overflow:hidden;font-weight:bold;">Sales rep title</td>
		<td style="color:rgb(0,0,0);font-family:Arial, Helvetica, sans-serif;font-size:12px;border:1px solid black; overflow:hidden;">{edgenuity_salesreptitle}</td>
		<td style="color:rgb(0,0,0);font-family:Arial, Helvetica, sans-serif;font-size:12px;border:1px solid black; overflow:hidden;">{genready_salesreptitle}</td>
		<td style="color:rgb(0,0,0);font-family:Arial, Helvetica, sans-serif;font-size:12px;border:1px solid black; overflow:hidden;">{imagine_salesreptitle}</td>
		<td style="color:rgb(0,0,0);font-family:Arial, Helvetica, sans-serif;font-size:12px;border:1px solid black; overflow:hidden;">{truenorth_salesreptitle}</td>
	</tr>
	<tr>
		<td class="labelCol" style="border:1px solid black;overflow:hidden;font-weight:bold;">Sales rep email</td>
		<td style="color:rgb(0,0,0);font-family:Arial, Helvetica, sans-serif;font-size:11px;border:1px solid black; overflow:hidden;"><a href="mailto:{edgenuity_salesrepemail}">{edgenuity_salesrepemail}</a></td>
		<td style="color:rgb(0,0,0);font-family:Arial, Helvetica, sans-serif;font-size:11px;border:1px solid black; overflow:hidden;"><a href="mailto:{genready_salesrepemail}">{genready_salesrepemail}</a></td>
		<td style="color:rgb(0,0,0);font-family:Arial, Helvetica, sans-serif;font-size:11px;border:1px solid black; overflow:hidden;"><a href="mailto:{imagine_salesrepemail}">{imagine_salesrepemail}</a></td>
		<td style="color:rgb(0,0,0);font-family:Arial, Helvetica, sans-serif;font-size:11px;border:1px solid black; overflow:hidden;"><a href="mailto:{truenorth_salesrepemail}">{truenorth_salesrepemail}</a></td>
	</tr>
	<tr>
		<td class="labelCol" style="border:1px solid black;overflow:hidden;font-weight:bold;">Sales rep phone</td>
		<td style="color:rgb(0,0,0);font-family:Arial, Helvetica, sans-serif;font-size:12px;border:1px solid black; overflow:hidden;">{edgenuity_salesrepphone}</td>
		<td style="color:rgb(0,0,0);font-family:Arial, Helvetica, sans-serif;font-size:12px;border:1px solid black; overflow:hidden;">{genready_salesrepphone}</td>
		<td style="color:rgb(0,0,0);font-family:Arial, Helvetica, sans-serif;font-size:12px;border:1px solid black; overflow:hidden;">{imagine_salesrepphone}</td>
		<td style="color:rgb(0,0,0);font-family:Arial, Helvetica, sans-serif;font-size:12px;border:1px solid black; overflow:hidden;">{truenorth_salesrepphone}</td>
	</tr>
	</tbody>
</table>
</div>
	<!-- jquery -->
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
	<!-- Latest compiled and minified JavaScript -->
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js"></script>
	<!-- Latest compiled and minified JavaScript -->
	<script src="https://system{{ subdomain }}.netsuite.com/c.1291624/TrueCloud/customerDisplay/datatables/js/jquery.dataTables.min.js"></script>
	<!-- jquery ui  (CALENDAR)-->
	<script src="https://system{{ subdomain }}.netsuite.com/c.1291624/TrueCloud/customerDisplay/js/jquery-ui.js"></script>
	<script src="https://system{{ subdomain }}.netsuite.com/c.1291624/TrueCloud/customerDisplay/js/jquery.qtip.min.js"></script>
	<script>
	$('#correspondenceTable').dataTable({
		"order": [[ 0, "desc" ]],
		"scrollY": "150px",
		"scrollX": false,
		"scrollCollapse": true,
		"paging": false,
		"dom": '<"top">t<"bottom"><"clear">'
	});
	$('#professional-services-table').dataTable({
		"order": [[ 0, "desc" ]],
		"scrollY": "150px",
		"scrollX": false,
		"scrollCollapse": true,
		"paging": false,
		"dom": '<"top">t<"bottom"><"clear">'
	});
	$('#taskTable').dataTable({
		"order": [[ 0, "desc" ]],
		"scrollY": "150px",
		"scrollX": false,
		"scrollCollapse": true,
		"paging": false,
		"dom": '<"top">t<"bottom"><"clear">'
	});
	$('#supportTable').dataTable({
		"order": [[ 0, "desc" ]],		
		"scrollY": "150px",
		"scrollX": false,
		"scrollCollapse": true,
		"paging": false,
		"dom": '<"top">t<"bottom"><"clear">'
	});
	$('#openHubs').dataTable({
		"order": [[ 0, "desc" ]],
		"scrollY": "100px",
		"scrollX": false,
		"scrollCollapse": true,
		"paging": false,
		"dom": '<"top">t<"bottom"><"clear">'
	});
	$('#openProj').dataTable({
		"order": [[ 0, "desc" ]],		
		"scrollY": "150px",
		"scrollX": false,
		"scrollCollapse": true,
		"paging": false,
		"dom": '<"top">t<"bottom"><"clear">'
	});
	$('#files').dataTable({
		"scrollY": "100px",
		"scrollX": false,
		"scrollCollapse": true,
		"paging": false,
		"dom": '<"top">t<"bottom"><"clear">'
	});

	//Build and populate cases url
	var casesURL = "https://system{{ subdomain }}.netsuite.com/app/common/search/searchresults.nl?searchtype=Case&Case_COMPANY=";
	casesURL += "{{entityid}}%20";
	casesURL += escape("{{companyname}}");
	casesURL += "&style=NORMAL&Case_COMPANYtype=STARTSWITH&report=&grid=&searchid=customsearch_customer_page_cases&dle=T&sortcol=Case_NUMBER_raw&sortdir=ASC&csv=HTML&OfficeXML=F&pdf=&size=1000"
	$('#cases-link').attr('href', casesURL);

/***************************
CHECKBOX FUNCTIONALITY
******************************/

	//store all the checkbox values
	var checkboxObj = {
		custentity_exempt_paevent :'{{ professional_dev.exempt_paevent }}',
		custentity_imp_mtg :'{{ professional_dev.imp_mtg }}',
		custentity_midyear_review :'{{ professional_dev.midyear_review }}',
		custentity_endofyear_review :'{{ professional_dev.endofyear_review }}',
		custentity_imp_plan_exempt :'{{ professional_dev.imp_plan_exempt }}',
		custentity_imp_plan_saved :'{{ professional_dev.imp_plan_saved }}',
		custentity_0_pd_remaining: '{{ professional_dev.custentity_0_pd_remaining}}',
		custentity_train_plan_saved: '{{ professional_dev.train_plan_saved}}',
		custentity_train_plan_exempt: '{{ professional_dev.train_plan_exempt}}'
	}
	//loop through all the checkbox keys and update the dom
	for(var key in checkboxObj){
		var tmpBool = checkboxObj[key];
		tmpBool = (tmpBool == 'F') ? false : true;
		if(tmpBool){document.getElementById(key).checked = true;}
	}

	//listen for when a checkbox is checked
	$('input[type="checkbox"]').on('click', function(){
		$el = $(this);
		//disable the checkboxes
		$("input:checkbox").attr('disabled','disabled');
		//disable datepickers
		$("input.date-box").attr('disabled','disabled');
		//ajax an update to the customer record
		var ajaxCall = $.ajax({
			url:'https://forms{{ subdomain }}.netsuite.com/app/site/hosting/scriptlet.nl?script=443&deploy=1&compid=1291624&h=3e8249eeec16f09f5696',
			dataType:'jsonp',
			jsonpCallback:'_',
			type:'get',
			data:{
				'customer' : '{{ internalid }}',
				'field' : $el.attr('id'),
				'value' : ($el.is(':checked')) ? 'T' : 'F',
				'action':'update'
			}
		});

		//SUCCESS:
		ajaxCall.done(function(data){
			//
			console.log('success',data);
			//enable the checkboxes
			$("input:checkbox").attr('disabled',false);
			//enabled the datepickers
			$("input.date-box").attr('disabled',false);
			//show updated message
		});

		//FAIL:
		ajaxCall.fail(function(data){
			//
			console.log('fail',data);
		});


	});



/***************************
DATE FUNCTIONALITY
******************************/
//add date selector
$('.date-box').datepicker();

//listen for when the date changes
$('.date-box').on('change',function(){
	$el = $(this);

	// change calendar into spinner
	$('#ui-datepicker-div').html('<img src="https://system{{ subdomain }}.netsuite.com/c.1291624/TrueCloud/calendar/img/ajax-loader2.gif"/>')
		//ajax an update to the customer record
		var ajaxCall = $.ajax({
			url:'https://forms{{ subdomain }}.netsuite.com/app/site/hosting/scriptlet.nl?script=443&deploy=1&compid=1291624&h=3e8249eeec16f09f5696',
			dataType:'jsonp',
			jsonpCallback:'_',
			type:'get',
			data:{
				'customer' : '{{ internalid }}',
				'field' : $el.attr('id'),
				'value' :$el.val(),
				'action':'update'
			}
		});

		//SUCCESS:
		ajaxCall.done(function(data){
			console.log('success',data);
			//enable the checkbox
			$el.after('<span class="response-fader">Updated<span>');
			$('.response-fader').fadeOut(5000);
			//show updated message
		});

		//FAIL:
		ajaxCall.fail(function(data){
			//
			console.log('fail',data);
		});
	});



/***************************
FILE FUNCTIONALITY
******************************/
$('.edit-file').on('click',function(e){
	e.preventDefault();
	var mediaitem = $(this).attr('data-file-id');
	edit_file(mediaitem);
});
$('.download-file').on('click',function(e){
	e.preventDefault();
	var mediaitem = $(this).attr('data-file-id');
	download_file(mediaitem);
});

/* Remove a file from an Entity (ex: Customer)
	id = Internal ID of the Entity
	mediaitem = Internal ID of the File
	*/
	function remove_file(mediaitem) {
		var url = '/app/common/media/importcrmmedia.nl?action=REMOVE&recordtype=&fkcol=kentity&fkval='+{{ internalid }}+'&mediaid='+mediaitem;
		var request = jQuery.ajax({
			'url': url
		});
	}

/* Popup a NetSuite-window to Edit a File
	mediaitem = Internal ID of the File
	*/
	function edit_file(mediaitem) {
		nlOpenWindow(
			'/app/common/media/mediaitem.nl?e=T&l=T&refresh=mediaitem&id='+mediaitem+'&id='+mediaitem, 'editpopup',
			'width=750,height=1000,resizable=yes,scrollbars=yes'
			);
	}

/* Download a File
	mediaitem = Internal ID of the File
	*/
	function download_file(mediaitem) {
		var url = nlapiLookupField('file', mediaitem, 'url');
		window.open(url+'&_xd=T', '_blank');
	}
	$(function(){
		$('.correspondance_msg').each(function(){
			$(this).html($.parseHTML($(this).text()));
			$(this).html($(this).text());
		});
	});

/* On load, remove x scrollbar */
$('.dataTables_scrollBody:has("#professional-services-table")').css('overflow-x','hidden');



var tooltip_data = {}, mchpin;
var edgenuity_complete = false, imagine_complete = false;
var edgenuity_start = false, imagine_start = false;

$(document).ready(function() {

	mchpin = "{{mch_pin}}";
	var toolip_orig = "{{{tooltip_content}}}" || '';
		if(toolip_orig){
			var tooltip_data = JSON.parse(unescape(toolip_orig));
		}else{
			var tooltip_data = {};
		}
		if(tooltip_data.bg_style){
			$('.dottedlink').attr('style',tooltip_data.bg_style);
		}
		console.log('tooltip_data line 1061:'+JSON.stringify(tooltip_data));
	$('#integratedtooltip').qtip({
		id: 'integratedtooltip',
		content: {
			title: 'Any red result means a connection cannot be made at this time. Contact your CRM administrator.',
			text: $('#theTableWrapper')
		},
		style: {
			classes: 'qtip-blue qtip-rounded'
		},
		position: {
	        at: 'left center',
	        my: 'bottom left',
	        effect: false,
	        viewport: $('.table_fields'),
	        container: $('.table_fields'),
	        adjust: {
	            method: 'shift none',
	            x:-650,
	            y:-20
	        }
	    },
		events: {
			show: function(event, api) {
				if (!mchpin) return;
				if (!imagine_start) {
					// console.log('no imagine_start');
					ajax_imagine(tooltip_data);
					$('#tooltip-searching').show();
					event.preventDefault();
				}
				if (!edgenuity_start) {
					$('#tooltip-searching').show();
					// console.log('no edgenuity_start');

					event.preventDefault();
				}
				if (!imagine_complete || !edgenuity_complete) {
					event.preventDefault();
					// console.log('getting out of fx');
					return;
				}
				var found = '#CFF56F', notfound = '#FF9494';
				var content = tooltip_custom.content();
				// console.log('tootip custom content: '+content);
				for (var company in tooltip_data) {

					// console.log('tooltip_data in for loop: '+JSON.stringify(tooltip_data));
					for (var key in tooltip_data[company]) {
						if (key === 'customerfound') {
							content = content.replace('{'+company+'_color}', tooltip_data[company][key] === true ? found : notfound);
						} else {
							if (tooltip_data[company][key]) {
								content = content.replace('{'+company+'_'+key+'}', tooltip_data[company][key]);
							} else {
								content = content.replace('{'+company+'_'+key+'}', '');
							}
						}
						/* Replace Email again */
							if (key.indexOf('email') != -1) {
								content = content.replace('{'+company+'_'+key+'}', tooltip_data[company][key] || '');
							}
					}
				}
				tooltip_custom.content(content);
			}
		}
	});
});

/* Content Template */

	var html = $('#theTableWrapper');

	var tooltip_custom = {
		content:function(html) {
			if (!html) {
				return $('.qtip-content').html();
			} else {
				$('.qtip-content').html(html);
			}
		}
	};

/* Ajax NetSuite 
	*/
	function ajax_edgenuity(tooltip_data) {
		edgenuity_start = true;
		var start = new Date();

		/* Execute Ajax */
			try {

				/* Execute Ajax */
					var ajaxCall = jQuery.ajax({
						url: 'https://forms{{ subdomain }}.netsuite.com/app/site/hosting/scriptlet.nl?script=539&deploy=1&compid=1291624&h=f7626b6e37d6c300117f&mch='+mchpin,
						dataType: 'jsonp',
						jsonpCallback:'_1',
						type:'get',
						data: null
					});

				/* Handle Ajax Responses */
					ajaxCall.done(function(data) {
						// console.log('Edgenuity Complete Success', data);
						edgenuity_complete = true;
						if (edgenuity_complete && imagine_complete) {
							$('#tooltip-searching').hide();
						}
						// console.log('data.truenorth.annualvalue: '+data.truenorth.annualvalue);
						// console.log('tooltip_data.truenorth.annualvalue: '+tooltip_data.truenorth.annualvalue);
						tooltip_data.edgenuity = data.edgenuity;
						tooltip_data.genready = data.genready;
						tooltip_data.truenorth.annualvalue = data.truenorth.annualvalue;
						tooltip_data.truenorth.rank = data.truenorth.rank;
						tooltip_data.truenorth.customersince = data.truenorth.customersince;
						tooltip_data.truenorth.lastpurchase = data.truenorth.lastpurchase;
						tooltip_data.edgenuity.customerfound = true;
						tooltip_data.genready.customerfound = true;
						tooltip_data.truenorth.customerfound = true;
						$('#integratedtooltip').mouseover();
					});
					ajaxCall.fail(function(jqXHR, textStatus, errorThrown) {
						edgenuity_complete = true;
						if (edgenuity_complete && imagine_complete) {
							$('#tooltip-searching').hide();
						}
						console.error('ajax.fail edgenuity', jqXHR, textStatus, errorThrown);
					});
			} catch(e) {

				console.log('handled error', e);
			}
	}
	function ajax_imagine(tooltip_data) {
		imagine_start = true;
		var start = new Date();

		/* Execute Ajax */
			try {

				/* Execute Ajax */
					var ajaxCall = jQuery.ajax({
						url: 'https://forms{{ subdomain }}.netsuite.com/app/site/hosting/scriptlet.nl?script=123&deploy=1&compid=912922&h=f18d2a3a291519805940&mch='+mchpin,
						dataType: 'jsonp',
						jsonpCallback:'_',
						type:'get',
						data: null
					});

				/* Handle Ajax Responses */
					ajaxCall.done(function(data) {
						// console.log('Imagine Complete Success', data);
						imagine_complete = true;
						if (edgenuity_complete && imagine_complete) {
							$('#tooltip-searching').hide();
						}
						tooltip_data.imagine = data.imagine;
						tooltip_data.imagine.customerfound = true;
						ajax_edgenuity(tooltip_data);
					});
					ajaxCall.fail(function(jqXHR, textStatus, errorThrown) {
						imagine_complete = true;
						if (edgenuity_complete && imagine_complete) {
							$('#tooltip-searching').hide();
						}
						console.error('ajax.fail imagine learning', jqXHR, textStatus, errorThrown);
						ajax_edgenuity(tooltip_data);
					});
			} catch(e) {

				console.log('handled error', e);
			}
	}
	</script>

<!-- 292 s: 58% #80 co: 0% #0 cache: 2% #33 -->
<!-- [ sb.a.j51.sv ] [ 2016.1.0.92 ]-->
<!-- [ 1291624 ] [  ] [ /s.nl ] [ Mon Jun 20 17:07:43 PDT 2016 ] -->
<!-- Not logging slowest SQL -->

